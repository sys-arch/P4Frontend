<div class="pagina-fondo">
  <div [ngClass]="{'calendario-contenedor': true, 'vista-semana': vista === 'semana'}">
    <!-- Botones de vista -->
    <div class="calendario-filtros">
      <button (click)="filtrarPorMes()">Ver por Mes</button>
      <button (click)="filtrarPorSemana()">Ver por Semana</button>
    </div>

    <!-- Nombre del mes -->
    <div class="calendario-nombre-mes">{{ nombreMes }}</div>

    <!-- Navegación de semanas solo visible en la vista de semana -->
    <div *ngIf="vista === 'semana'" class="semana-navegacion">
      <button class="boton-navegacion-izquierda" (click)="anteriorSemana()">&larr;</button>
      <span class="semana-titulo">{{ obtenerNumeroSemana() }} semana de {{ obtenerNombreMes(mesActual) }}</span>
      <button class="boton-navegacion-derecha" (click)="siguienteSemana()">&rarr;</button>
    </div>

    <!-- Encabezado de días de la semana -->
    <div class="calendario-grid calendario-header">
      <div class="calendario-header-dia">Lun</div>
      <div class="calendario-header-dia">Mar</div>
      <div class="calendario-header-dia">Mié</div>
      <div class="calendario-header-dia">Jue</div>
      <div class="calendario-header-dia">Vie</div>
      <div class="calendario-header-dia">Sáb</div>
      <div class="calendario-header-dia">Dom</div>
    </div>

    <!-- Vista mensual -->
    <div *ngIf="vista === 'mes'" class="calendario-grid calendario-dias">
      <div
        *ngFor="let dia of diasFiltrados"
        [ngClass]="{'calendario-dia': dia, 'calendario-dia-vacio': !dia}">
        <div *ngIf="dia" class="calendario-dia-numero">{{ dia?.getDate() }}</div>
        <!-- Botón "Crear Reunión" solo si el día pertenece al mes seleccionado -->
        <button 
      *ngIf="dia && dia.getMonth() === mesActual && dia.getDay() !== 0 && dia.getDay() !== 6" 
      class="btn-crear-reunion" 
      (click)="abrirModalReunion(dia, '08:00')">
      +
    </button>
      </div>
    </div>

    <!-- Vista semanal -->
    <div *ngIf="vista === 'semana'" class="semana-vista">
      <!-- Columna de horas -->
      <div class="horas-column">
        <div *ngFor="let hora of horas" class="hora-item">{{ hora }}</div>
      </div>

      <!-- Rejilla de días y eventos -->
      <div class="calendario-semana-grid">
        <div
          *ngFor="let dia of diasFiltrados"
          [ngClass]="{'calendario-dia-semana': dia, 'calendario-dia-vacio': !dia}">
          <div *ngIf="dia" class="calendario-dia-numero">{{ dia?.getDate() }}</div>
          <div class="calendario-horas">
            <div
              *ngFor="let hora of horas"
              class="hora-evento"
              [ngClass]="dia ? obtenerClaseReunion(dia, hora) : ''"
              (click)="dia && dia.getDay() !== 0 && dia.getDay() !== 6 ? abrirModalReunion(dia, hora) : null"
              [class.no-click]="dia && (dia.getDay() === 0 || dia.getDay() === 6)">
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Botones de navegación de meses -->
    <button *ngIf="vista === 'mes'" class="boton-navegacion izquierdo" (click)="mesAnterior()">&larr;</button>
    <button *ngIf="vista === 'mes'" class="boton-navegacion derecho" (click)="mesSiguiente()">&rarr;</button>
  </div>

  <!-- Leyenda -->
  <div class="leyenda">
    <div class="leyenda-item">
      <span class="leyenda-circulo organizador"></span> Organizador
    </div>
    <div class="leyenda-item">
      <span class="leyenda-circulo asistente"></span> Asistente
    </div>
    <div class="leyenda-item">
      <span class="leyenda-circulo asistida"></span> Asistida
    </div>
    <div class="leyenda-item">
      <span class="leyenda-circulo no-asistida"></span> No asistida
    </div>
  </div>
</div>
